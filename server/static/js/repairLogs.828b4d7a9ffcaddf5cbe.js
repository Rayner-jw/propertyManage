webpackJsonp([7],{0:function(e,t){},"3Upj":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),i=a("bKyE"),n=a("HPMl"),r=a("mvHQ"),o=a.n(r),l=a("zL8q"),c=a("51Er"),p={name:"repairLogs",data:function(){return{uid:localStorage.uid,tableData:[],currentPage:1,pageSize:5,total:0,formatDate:c.a,formInline:{},paras:{},searchs:[],dialogTableVisible:!1,dealWithRepair:!1,repairBy:"",repairId:"",curIndex:""}},created:function(){this.pageEvent()},methods:{search:function(){for(var e in this.dialogTableVisible=!1,this.searchs=[],this.formInline)""!=this.formInline[e]&&this.searchs.push(this.formInline[e]);this.paras=JSON.parse(o()(this.formInline)),void 0!==this.formInline.repairProcess&&""!=this.formInline.repairProcess&&("未处理"==this.formInline.repairProcess?this.paras.repairProcess=0:"维修中"==this.formInline.repairProcess?this.paras.repairProcess=1:"已完成"==this.formInline.repairProcess?this.paras.repairProcess=2:this.paras.repairProcess=3),this.pageEvent(this.paras)},handleSizeChange:function(e){this.pageSize=e,this.pageEvent(this.paras)},handleCurrentChange:function(e){this.currentPage=e,this.pageEvent(this.paras)},pageEvent:function(e){void 0===e&&(e={});var t={pageSize:this.pageSize,currentPage:this.currentPage,searchs:e};this.$http.post("http://localhost:3000/admin/repairs",t).then(function(e){this.tableData=e.body.results,void 0!==e.body.total&&(this.total=e.body.total)},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Object(l.Message)({type:"error",message:t})})},delEvt:function(e,t){var a=this;1==Number(e.repairProcess)?Object(l.Message)({type:"warning",message:"维修工作已在进行，无法删除"}):l.MessageBox.confirm("删除后将无此条数据，是否确定删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.confirmDel(e.repairId,t)}).catch(function(){})},confirmDel:function(e,t){this.$http.delete("http://localhost:3000/admin/repairs?repairId="+e).then(function(e){this.tableData.splice(t,1),Object(l.Message)({type:"success",message:"已删除记录"})},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Object(l.Message)({type:"error",message:t})})},repairEvt:function(e,t){this.dealWithRepair=!0,this.repairId=e.repairId,this.curIndex=t},dealWith:function(e,t,a){var s={repairId:e,repairBy:this.repairBy},i=JSON.parse(o()(this.tableData[t]));void 0!==a?(delete s.repairBy,this.finishTime=Object(c.a)(new Date,"yyyy-MM-dd HH:mm:ss"),s.finishTime=this.finishTime,i.finishTime=this.finishTime,i.repairProcess=2):(i.repairBy=this.repairBy,i.repairProcess=1),this.dealWithRepair=!1,this.$http.put("http://localhost:3000/admin/repairs",s).then(function(e){this.tableData.splice(t,1,i),Object(l.Message)({type:"success",message:e.body.msg})},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Object(l.Message)({type:"error",message:t})})},finishEvt:function(e,t){var a=this;l.MessageBox.confirm("请确定维修是否完成","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.dealWith(e.repairId,t,"ar3")}).catch(function(){})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"repairLogs"},[a("span",{staticClass:"title"},[e._v("住户报修记录")]),e._v(" "),a("div",{staticClass:"main"},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("查询")]),e._v(" "),a("el-breadcrumb",{attrs:{separator:"+"}},e._l(e.searchs,function(t,s){return a("el-breadcrumb-item",{key:s+""},[e._v(e._s(t))])}))],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,align:"center",width:"100%"}},[a("el-table-column",{attrs:{type:"expand",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"expandDiv"},[a("h3",[a("span",[e._v("["+e._s(t.row.repairType)+"]")]),e._v(" "),a("span",[e._v(e._s("0"==t.row.repairProcess?"未处理":"1"==t.row.repairProcess?"维修中":"2"==t.row.repairProcess?"已完成":"已取消"))])]),e._v(" "),a("div",{staticClass:"expandMain"},[a("span",[e._v(e._s(e.formatDate(new Date(t.row.applicantTime),"yyyy-MM-dd HH:mm:ss")))]),e._v(" "),a("span",[e._v("地点："+e._s(t.row.applicantAddress))]),e._v(" "),a("span",[e._v("联系电话："+e._s(t.row.applicantPhone))])]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v(e._s(t.row.repairContent))]),e._v(" "),"0"==t.row.repairProcess?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.repairEvt(t.row,t.$index)}}},[e._v("处理报修")]):"1"==t.row.repairProcess||"2"==t.row.repairProcess?a("div",{staticClass:"expandMain"},[a("span",[e._v("维修人员："+e._s(t.row.repairBy))]),e._v(" "),"1"==t.row.repairProcess?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.finishEvt(t.row,t.$index)}}},[e._v("确认完成")]):e._e(),e._v(" "),"2"==t.row.repairProcess?a("span",[e._v("完成时间："+e._s(e.formatDate(new Date(t.row.finishTime),"yyyy-MM-dd HH:mm:ss")))]):e._e()],1):a("span",[e._v("业主取消了该次报修")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"repairProcess",label:"状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("0"==t.row.repairProcess?"未处理":"1"==t.row.repairProcess?"维修中":"2"==t.row.repairProcess?"已完成":"已取消"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"repairType",label:"类型","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"applicantPhone",label:"联系电话","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"applicantAddress",label:"维修地点","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"时间","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatDate(new Date(t.row.applicantTime),"yyyy-MM-dd HH:mm:ss")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"repairContent",label:"内容","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"","min-width":"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.delEvt(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{margin:"10px 0 20px 0"},attrs:{"current-page":e.currentPage,"page-sizes":[5,10,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"查询条件",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-form",{attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"报修人"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.formInline.applicant,callback:function(t){e.$set(e.formInline,"applicant",t)},expression:"formInline.applicant"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"处理状态"}},[a("el-select",{attrs:{placeholder:""},model:{value:e.formInline.repairProcess,callback:function(t){e.$set(e.formInline,"repairProcess",t)},expression:"formInline.repairProcess"}},[a("el-option",{attrs:{label:"",value:""}}),e._v(" "),a("el-option",{attrs:{label:"已完成",value:"已完成"}}),e._v(" "),a("el-option",{attrs:{label:"维修中",value:"维修中"}}),e._v(" "),a("el-option",{attrs:{label:"未处理",value:"未处理"}}),e._v(" "),a("el-option",{attrs:{label:"已取消",value:"已取消"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:""},model:{value:e.formInline.repairType,callback:function(t){e.$set(e.formInline,"repairType",t)},expression:"formInline.repairType"}},[a("el-option",{attrs:{label:"",value:""}}),e._v(" "),a("el-option",{attrs:{label:"自家",value:"自家"}}),e._v(" "),a("el-option",{attrs:{label:"公共",value:"公共"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"处理报修",visible:e.dealWithRepair},on:{"update:visible":function(t){e.dealWithRepair=t}}},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"维修人员"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.repairBy,callback:function(t){e.repairBy=t},expression:"repairBy"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dealWith(e.repairId,e.curIndex)}}},[e._v("确定")])],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(p,u,!1,function(e){a("yWcW")},null,null).exports,m={name:"App",components:{MenuNav:i.a,AdminHomeHeaderNav:n.a,RepairLogs:d}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"lf"},[t("MenuNav")],1),this._v(" "),t("div",{staticClass:"lr"},[t("AdminHomeHeaderNav"),this._v(" "),t("RepairLogs")],1)])},staticRenderFns:[]};var v=a("VU/8")(m,f,!1,function(e){a("nYmN")},null,null).exports,h=a("8+8L");a("tvR6"),a("cF5e");s.default.use(h.a),s.default.use(l.Form),s.default.use(l.FormItem),s.default.use(l.Input),s.default.use(l.Button),s.default.use(l.Menu),s.default.use(l.Submenu),s.default.use(l.MenuItem),s.default.use(l.MenuItemGroup),s.default.use(l.Badge),s.default.use(l.Dropdown),s.default.use(l.DropdownMenu),s.default.use(l.DropdownItem),s.default.use(l.Pagination),s.default.use(l.Table),s.default.use(l.TableColumn),s.default.use(l.Select),s.default.use(l.Option),s.default.use(l.Breadcrumb),s.default.use(l.BreadcrumbItem),s.default.use(l.Dialog),s.default.config.productionTip=!1,new s.default({el:"#app",template:"<App/>",components:{App:v}})},"51Er":function(e,t,a){"use strict";a.d(t,"a",function(){return s});var s=function(e,t){var a={yyyy:e.getFullYear(),yy:(""+e.getFullYear()).slice(-2),M:e.getMonth()+1,MM:("0"+(e.getMonth()+1)).slice(-2),d:e.getDate(),dd:("0"+e.getDate()).slice(-2),H:e.getHours(),HH:("0"+e.getHours()).slice(-2),h:e.getHours()%12,hh:("0"+e.getHours()%12).slice(-2),m:e.getMinutes(),mm:("0"+e.getMinutes()).slice(-2),s:e.getSeconds(),ss:("0"+e.getSeconds()).slice(-2),w:["日","一","二","三","四","五","六"][e.getDay()]};return t.replace(/([a-z]+)/gi,function(e){return a[e]})}},HPMl:function(e,t,a){"use strict";var s={name:"adminHomeHeaderNav",data:function(){return{notify:[],message:[],account:""}},created:function(){this.$http.get("http://localhost:3000/admin/notify/notify").then(function(e){this.notify=e.body.results[0],this.account=e.body.account},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Message({type:"error",message:t})}),this.$http.get("http://localhost:3000/admin/notify/message").then(function(e){this.message=e.body.results[0]},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Message({type:"error",message:t})})},methods:{logOut:function(){this.$http.post("http://localhost:3000/logOut").then(function(e){location.href=e.body.url},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Message({type:"error",message:t})})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"adminHomeHeaderNav"},[a("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"}},[a("el-badge",{staticClass:"icon",attrs:{value:e.message.complain+e.message.message,hidden:e.message.complain+e.message.message==0}},[a("i",{staticClass:"my-icon my-icon-3"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("div",{staticClass:"dropdownBox"},[a("h4",[e._v(" "+e._s(e.message.complain+e.message.message!=0?"有未处理消息":"暂无消息")+" ")]),e._v(" "),0!=e.message.complain?a("span",[a("a",{attrs:{href:"/admin/complainLogs"}},[e._v("收到"+e._s(e.message.complain)+"条投诉信息")])]):e._e(),e._v(" "),0!=e.message.message?a("span",[a("a",{attrs:{href:"/admin/receiveMsgs"}},[e._v("收到"+e._s(e.message.message)+"条私发信息")])]):e._e()])])],1),e._v(" "),a("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"}},[a("el-badge",{staticClass:"icon",attrs:{value:e.notify.repair+e.notify.userinfo,hidden:e.notify.repair+e.notify.userinfo==0}},[a("i",{staticClass:"my-icon my-icon-gonggao"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("div",{staticClass:"dropdownBox"},[a("h4",[e._v(" "+e._s(0!=e.notify.length?"有未处理通知":"暂无通知")+" ")]),e._v(" "),0!=e.notify.userinfo?a("span",[a("a",{attrs:{href:"/admin/profiles"}},[e._v("收到"+e._s(e.notify.userinfo)+"条用户审核通知")])]):e._e(),e._v(" "),0!=e.notify.repair?a("span",[a("a",{attrs:{href:"/admin/repairLogs"}},[e._v("收到"+e._s(e.notify.repair)+"条用户报修通知")])]):e._e()])])],1),e._v(" "),a("el-dropdown",{staticClass:"icon_me",attrs:{trigger:"click",placement:"bottom"}},[a("el-badge",{staticClass:"icon"},[a("i",{staticClass:"my-icon my-icon-iconuser"})]),e._v(" "),a("el-dropdown-menu",{staticClass:"userBox",attrs:{slot:"dropdown"},slot:"dropdown"},[[a("li",[e._v(e._s("管理员 "+e.account))]),e._v(" "),a("li",{staticClass:"line"}),e._v(" "),a("li",[a("a",{attrs:{href:"/admin/setting"}},[e._v("安全设置")])]),e._v(" "),a("li",{staticClass:"line"}),e._v(" "),a("li",{on:{click:e.logOut}},[e._v("退出")])]],2)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(e){a("mVfP")},null,null);t.a=n.exports},bKyE:function(e,t,a){"use strict";var s=a("zL8q"),i={name:"menuNav",data:function(){return{uid:localStorage.uid,menus:[]}},created:function(){void 0===this.uid&&(Object(s.Message)({type:"warning",message:"登录信息已失效，请重新登录"}),setTimeOut(function(){location.href="/"},2e3)),this.$http.get("http://localhost:3000/menus?uid="+this.uid).then(function(e){this.menus=e.body},function(e){if(void 0===e.body.msg)var t="服务器正在维护，造成不便，请理解！";else t=e.body.msg;Object(s.Message)({type:"error",message:t})})},methods:{}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menuNav"},[a("el-menu",{staticClass:"menu",attrs:{"unique-opened":!0,"background-color":"#222d32","text-color":"#fff","active-text-color":"#ffd04b"}},e._l(e.menus,function(t,s){return a("el-submenu",{key:s,attrs:{index:s+""}},[a("template",{slot:"title"},[a("i",{class:t.icon}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.menuName))])]),e._v(" "),e._l(t.childs,function(t,i){return a("el-menu-item",{key:i,attrs:{index:s+"-"+i}},[a("a",{attrs:{href:t.url}},[e._v(e._s(t.name))])])})],2)}))],1)},staticRenderFns:[]};var r=a("VU/8")(i,n,!1,function(e){a("j/pX")},null,null);t.a=r.exports},cF5e:function(e,t){},"j/pX":function(e,t){},mVfP:function(e,t){},nYmN:function(e,t){},tvR6:function(e,t){},yWcW:function(e,t){}},["3Upj"]);
//# sourceMappingURL=repairLogs.828b4d7a9ffcaddf5cbe.js.map